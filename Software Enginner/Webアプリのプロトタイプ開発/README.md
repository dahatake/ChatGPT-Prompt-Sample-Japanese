# Webアプリのプロトタイプ開発

ChatGPT あるいは Azure OpenAI Services の PlayGround などで行います。

こちらが ChatGPT でのチャット履歴になります。
https://chat.openai.com/share/77fb25ed-2fae-4733-b7a6-fa3128b0f0b2


Azure OpenAI Services の PlayGround:

https://learn.microsoft.com/ja-jp/azure/ai-services/openai/chatgpt-quickstart?tabs=command-line%2Cpython&pivots=programming-language-studio

プロトタイプの実装では、利用する製品・サービス・テクノロジーを決めます。

ここでは、サーバー側の処理は Microsoft Azure で。Webアプリは Vue.JS で行います。これはご自身の好みで😊

Vue.JS 入門:

https://learn.microsoft.com/ja-jp/training/paths/vue-first-steps/


# 1. 要件定義

## 1.1 作りたいビジネスシナリオを決める

ここは、思いつくものを書いてみました。他にもあると思いますが。

テーマ: 観光発掘

ターゲットユーザー:

- 郡山に来た人がスムーズに過ごせるように
- ペルソナ: 私 @dahatake

@dahatake の悩み:

- 美味しいごはんを食べたい
- ステキな景色をみたい
- 移動手段を何とかしたい
- 支払い方法を簡略化したい

## 1.2. リサーチ

お客様ご担当者でも理解していない、あるいは、別視点での情報もあるかもしれません。Microsoft Copilot (a.k.a. Bing Chat)で探します。

Prompt:
```cmd
郡山の魅力的な観光情報についてリストアップしてください。歴史的な場所、絶景、他にはない体験、郡山ならではのレストラン、ツーリングなども挙げてください。
可能な限り、その情報についての背景やストーリーも挙げてください。
```

```cmd
観光地を分類するタグを考えてください。
```


# 2. 要件を定義する

ドキュメントは作成しません。あくまで、チームメンバー内で共有できればいいという最低限のものを。
ChatGPT を使います。

## 2.1.　要件定義

機能要件、非機能要件、アプリケーションの構成、そして実装計画を作成していきます。
ちなみに、要件定義にはどんな項目があるのかは、Microsoft Copilot (a.k.a. Bing Chat)に聞くと最良です。

例:
```cmd
アプリケーション開発のための業務要件の定義をするためには、どんな項目を決定する必要がありますか?
```

### 2.1.1. 機能要件の作成

要件定義は**ユースケース**として作成します。勿論、ユーザーとの会議などで議事録やメールのやり取りの文章があったら、そこから作成してもいいかと思います。

Prompt:
```cmd
# 役割:
あなたは世界最高峰のコンサルタントです。ソフトウェアエンジニアリングにも非常に長けています。

# 指示:
以下のユーザーストーリーからユースケースを考えてください。

# ユーザーストーリー:
- 福島県郡山市の観光をする観光客をサポートするWebアプリケーションを作成したい
- 美味しいごはんを食べたい
- ステキな景色をみたい
- 移動手段を何とかしたい
- 支払い方法を簡略化したい
- スマホがメインターゲットのデバイス。勿論、同じデータをPCからも使いたい
```

### 2.1.2. 機能要件の作成

```cmd
# 指示:
作成したユースケースから機能要件を抽出してください。以下の項目が必要です。

# 項目:
- アプリケーション開発の目的や背景
- 対象ユーザーや利用シーン
- 主要な機能やサービス
- 画面や操作
- 外部サービスとのやり取り
- 他のアプリケーションやサービスとの依存関係
```

### 2.1.3. 非機能要件の作成

非機能要件は、緩く作成するわけにはいきません。それでも可能な限り後から変更できるのが望ましいです。

Prompt:

「文章: ###」には、メールのやり取りなどを入力します。ここでは雑に入れています。


```cmd
# 指示:
以下のヒアリングドキュメントから、非機能要件を抽出してください。非機能要件には以下の項目が必要です。分からなかったら「不明」とします。

# 項目:
- 可用性
- 性能・拡張性
- 運用・保守性
- 移行性
- セキュリティ
- 環境・サステナビリティ

# ヒアリングドキュメント:
システムに求められる非機能要件ですか、そうですね。まあやっぱり止まらないようにしてほしいなと思います。あの休日も正月もそうですけどね。それからユーザーの数はまあ、おそらくですけど、同時にそうですね。100人くらい捌ければいいのかなと思うんですよ。で、後から機能を追加するかもしれないので、ええ、そこの対応ができればいいかなと思ってます。ええそうですね。データのバックアップとかもちろんした方がいいとは思うんですけど、特にええとユーザーさんの課金の情報とか、予約の情報っていうのは、私たちの方で管理するってよりもそうですね。その連携サイトの方で、もちろん持っているわけですけど、ある程度はこちらでも持っておきたいですね。でも多分なくなると困るから、それは24時間 365日すぐでも戻せるようにしてほしいと思います。まあいつお客さんいらっしゃってるかわかりませんからね。予約も含めて現行のシステムはありません。新規に全部作ります。セキュリティですけどね。えっと、もちろんですけど、個人情報に近いところを管理することになると思いますから、その部分に関してはすごく厳密なものが必要だと思います。エコロジーですか。太陽光発電なんかが使える環境があると、いいかなと思いますけどね。まぁほとんどスマホの中のアプリケーションだから、そこまではないかなと思います
```

### 2.1.4. アプリケーションの構成

どんなアーキテクチャになるのか。ざっくりと作成します。

Prompt:
```cmd
# 指示:
これまでの情報を基にアプリケーションのアーキテクチャを作成してください。
アプリケーションアーキテクチャの図はMermaid記法で作成してください。
```

作成した写真から、Microsoft Azure のどのサービスを使うのかを考えさせます。

**GTP-4 with Vision** を使います。

Promot:
```cmd
アプリケーションをMicrosoft Azureにデプロイします。
この画像を参考にして、以下の条件を満たすMicrosoft Azureのサービスと、なぜそのサービスを選定したのかの理由を、日本語で、箇条書きで作成してください。

# 条件:
- SPAのWebアプリ
- 可能な限りServerlessを使いたい。初期リリースのコストを抑えるため
- ユーザー数が増えたら容易にスケールアウト出来るようにしたい
```

### 2.1.5. 実装計画

ここもざっくりと。

Prompt:
```cmd
ユースケースと実装のための情報参考にして優先順位を設定して、マイルストーンを作成してください。初期リリースに必要なものは、全て最優先にしてください。マイルストーンの図はMermaid記法で作成してください。

# 実装のための情報:
- 初期リリースは3か月後
- 開発者の数は3名
- 最初に以下の機能を提供
    - 初期リリースのマイルストーン
```

この分量になると、Microsoft Word などに貼り付けて、継続利用もいいかもしれません😊

Pandoc の様なツールで。WordからWikiやMarkdownなどに変換できます。
https://github.com/jgm/pandoc

それか Markdown 書式のまま GitHub でもいいかもしれないです。

## 2.2. 各種設計図作成

ここから先は、**Software Engineering** の作業となります。

### 2.2.1. データモデル

Prompt:
```cmd
これらのユースケースをシステムとして実現するために、どの様なデータモデルが考えられますか?
Mermaid記法で作成してください。
```

### 2.2.2. 画面遷移図

Prompt:

```cmd
ユーザーが操作する画面の画面遷移図をMermaid記法で作成してください。
```

### 2.2.3. アプリケーション アーキテクチャ図

Prompt:

```cmd
これまでの情報を基にアプリケーションのアーキテクチャをMermaid記法で作成してください
```


## 3. プロトタイプ作成

### 3.1. データモデル

DBは、SQLでもNoSQLでもどちらでもいいです。

Prompt:
```cmd
サンプルのデータを作成してください。
```


SQL Server の例です。
Promot:
```cmd
Azure SQL Database を使います。テーブルの作成のSQL文を作成してください。
```

```cmd
サンプルのデータを Azure SQL Database に登録するSQL文を作成してください。
```

Azure Comsmos DB SQL API用です。

Promot:
```cmd
サンプルのデータを Azure Cosmos DB SQL API 用に作成してください
```

### 3.2. 画面作成

最低限動くものを作成する。「画面」は、マイルストーンの初期フェーズの中で、自分のタスクのものを選択してもいいかと思います。

DALL-E を使って、画像のサンプルを作成します。

Prompt:
```cmd
# 役割:
あなたはデザイナーです。

# 指示:
- {福島県郡山市の観光客をサポートするためのWebアプリケーションのユースケース}の情報を基に、Web画面のもとになる画像を4つ作成してください。
- 画像の中に文字は入れないでください。
```

画像から、HTMLを作成します。

Prompt:
```cmd
# 指示:
その画像からWebアプリケーションの画面で使う、HTMLとCSSを作成してください。
{Vue.js と HTML を使用してホーム画面、ログイン画面、レストラン検索と予約システムの基本的な構造を示す例}で作成したコードを基にしてください。

# 対象画面:
- ホーム画面
- ログイン画面
- レストラン検索と予約システム
```

Prompt:
```cmd
作成したVue.js のテンプレートをホスティングするHTMLを作成してください。先のVue.jsのコンポーネントを組み込んでください。
```
Promot:
```cmd
サンプルのデータを Vue.js 用に作成してください
```

### 3.3. API

サーバー側のAPIのひな型を作成します。
どこから始めてもいいのですが。ここではクライアント-APIが動作したら。DB保存ロジックを組みます😊

```cmd
Vue.jsから呼び出すサーバー側の API を Azure Functions にホストする C# で作成します。以下の{レストラン検索ロジック}のAPI実装の通りコードを作成してください。

# {レストラン検索ロジック}のAPI実装:
- DBへの保存ロジックはここでは実装しません。APIを呼び出したらサンプルデータを返します
- サンプルデータは、先に作成したレストランデータを使います
- 項目毎にAPIにもパラメーターを設定して、DB検索時にフィルタリングが出来るようにします
```

クライアント側から、サーバーのAPIを呼び出すコードを作成します。

```cmd
先ほど作成した{レストラン検索と予約システム}画面を以下の条件で更新してください。

# 条件:
- レストラン検索ロジックのAPIを呼び出す
- Azure Functions のURLは後で書き換えるため、ここではダミーを用いる
```

動作確認したら、DB保存のコードと入れ替えます。

```cmd
Azure Functionsのコードに、DBへの検索をするコードを追加します。以下の{レストラン検索ロジック}のAPI実装の通りコードを作成してください。

# {レストラン検索ロジック}のAPI実装:
- Azure SQL Database からデータを検索します。
- Azure SQL Database には、先に作成した{Azure SQL Database で使用するためのサンプルデータ}は、格納済みであるとします
- Azure SQL Database への接続情報は、後で設定できるようにします。
- 項目毎にAPIにもパラメーターを設定して、DB検索時にフィルタリングが出来るようにします
```

### 4. レポート作成

DBに日本語での別名(エリアス)を入れなくても、作成してくれます😊

Prompt:
```cmd
Azure SQL Database に対して、以下の処理をするクエリを、SQL文で作成してください。

# クエリ:
一番人気のあるレストランはどこですか?
```

### 5. Cloud 環境作成

Microsoft Azure のコンピュートなどを作成して、デプロイをします。

Prompt:
```cmd
アプリケーションアーキテクチャの中の全てのコンポーネントをMicrosoft Azure で動かします。
コストを安く抑えるためにServerlessをなるべく使いたいです。かつスケールアウトできるサービスを選択したいです。それぞれのコンポーネントに最適なMicrosoft Azureのサービスは何ですか?その理由も教えてください。
```


Prompt:
```cmd
それぞれのMicrosoft Azureのサービス作成をするAzure CLIのコードを作成してください。
アプリケーションの名前は「KoriyamaApps」にします。変数名のプリフィックスとしてください。
```

### 6. 作成したコードのダウンロード

ChatGPTの場合は、Code Interpreterが統合されています。作成したファイルのダウンロードが出来ます。

```cmd
会話の最初から、ここまでに作成した全てのスクリプトやコードの種類一覧を箇条書きにしてください。
```

```cmd
会話の最初から、ここまでに作成した全てのスクリプトやコードをダウンロードできるようにしてください。ゴール達成のステップに不足があったら補ってください。

# ファイルダウンロードのステップ:
ステップ1: コードの一覧を作成
ステップ2: 一覧のアイテムごとにファイルのダウンロードの準備
ステップ3: 全てのファイルをzip圧縮
ステップ4: ダウンロードの準備
```

ドキュメントもダウンロードしましょう。

```cmd
会話の最初から、ここまでに作成した全てのスクリプトやコード以外のドキュメントもダウンロードできるようにしてください。
```

# 4. メモ
外部サービスの呼び出しをしたいです。Bing Chat や Google Search などで、郡山の観光データベースを探します。

Copilot (旧Bing Chat)

Prompt:
```cmd
福島県郡山市の観光名所をAPIとして公開しているサービスはありますか?
```
残念ながらありませんでした。

ですが、以下のサイトは見つかりました。となれば、これをデータベース化する必要がありますね。

https://www.kanko-koriyama.gr.jp/

ここでは残念ですが、幾つかを手作業で入手することにします。Excel に搭載されている Power Query を使って、ローカルにCSVとして出力します。