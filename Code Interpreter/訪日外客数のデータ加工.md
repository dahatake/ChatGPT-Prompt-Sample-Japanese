# 訪日外客者数の推移の分析

データの分析のための一連の流れにチャレンジします。最も面倒で手間であるデータ加工にチャレンジします。

# データの準備

以下よりファイルをダウンロードします。

[時系列推移表]の[国籍/月別 訪日外客数 (2003年-2023年) (Excel)]をダウンロードします。

https://www.jnto.go.jp/statistics/data/visitors-statistics/

ダウンロードしたファイルは、こちらにもあります。

Excelファイル: [ファイル](/[Plugin]%20Code%20Interpreter/data/since2003_visitor_arrivals_May_2023.xlsx)

# Prompt

prompt:
```cmd
### 役割 ###
データエンジニアのプロフェッショナルとして振舞ってください。

### 指示 ###
アップロードしたExcelのデータのクレンジングをします。その後、データの分析に入ります。指示をするまで分析には入らないでください。
Step by Step で実行してください。
```


## 1. ファイルのアップロード
ファイルをアップロードします。
それと当時に以下の Prompt を入力してみます。

Prompt:

Userd----
```cmd
### 指示 ###
データのクレンジングと加工を行います。「年月日」「国名」「訪日外客数」をもつデータを作成します。Step by Step で実行してください。
以下を参考にしてください。

- 加工後のデータの例
- Excelファイルの特徴
- データ加工方法

### 加工後のデータの例 ###
| 年月日 | 国名 | 訪日外客数 |
| --- | --- | --- |
| 2023/1/1 | 韓国 | 20344 |
| 2022/12/1 | 韓国 | 22004 |
| 2023/1/1 | 台湾 | 123450 |
| 2022/12/1 | 台湾 | 9930 |

### Excelファイルの特徴 ###
- Excelファイルの1つのシートに、1年分のデータがあります
- 最新の年は、入力が完了していないことがあります
- 国と月でデータがクロス集計されています
 
### データ加工方法 ###
- 2019年以前のシートと、2020年以降のシートで「国名」の列のレイアウトが異なっています
- 2020年以降のシートは、「国名」がA列とB列にまたがって入力されているデータがあります。A列にデータが入っていれば、A列のデータを。A列にデータが入っていない場合は、B列のデータを「国名」にしてください
- 各シートの上位３行を削除してください
- 「注」などが入力されている注釈の行を削除してください
- 「伸率」「累計」の列を削除してください
- 「総数」「計」「累計」「地域」の文字を含むデータを削除してください。
- 「国名」データの前後のスペースを削除してください
- 「年月日」は、「YYYY/MM/01」という日付型に変換をしてください
```


## 2. データの加工
最初の Prompt だけでも結構データの加工をしてくれます。行列変換や複数のシートのマージなど。凄いです。

出力データ次第ですが。
作成データの**RESULT**を確認して、適時指示をしていきます。

Prompt:
```cmd
作成されたデータの内容を確認したいので、基礎解析を行ってください。
```

データの内容がおかしいと思ったら、データを保存して、ダウンロードして内容を確認します。

Prompt:
```cmd
データをCSVの形式で保存してください。
```



## 3. データの分析実行

グラフ作成時に日本語が文字化けします。matplotlib 用のフォントファイルを一緒にアップロードします。

Prompt:

```cmd
作成したデータを使って、データの分析を行います。Step by Step で実行してください。

- 考えられる全ての分析を試してください
- データの分析結果の説明も作成してください。それぞれについてグラフを作成してください
- グラフの中の文字は、アップロードしたファイルの中にあるフォントを使って、可能な限り日本語で表示してください
```

もし、分析の次のタスクの提示がないようであれば。以下の様にタスクを指定します。

Prompt:

```cmd
考えられる全ての分析を行います。例えば、時系列での傾向、旅行者が日本を訪れる目的ごとの割合とその履歴、構成比、地理的な分布、特性、相関関係などです。
データの分析結果の説明も作成してください。
分析結果を最適なグラフで表示してください。グラフの全ての文字列を日本語で表示したいので、アップロードしたファイルの中のフォントファイルを使ってください。
```

Prompt:

```cmd
分析結果の特徴的な項目を3つリストアップして説明文を作成してください。
```

## 4. 結果をファイルに出力

作業結果の保存です。

Prompt:
```cmd
### 指示 ###
先ほど実施した全てのデータ分析結果を使ってPowerPointのスライドを作成します。python-pptxを使用してください。
グラフの全ての文字列を日本語で表示したいので、アップロードしたファイルの中のフォントファイルを使ってください。

### プレゼンテーション構成 ###
Step1: 全体のサマリーとFAQを作成して、最初のスライドに追加する
Step2: 分析した項目毎に、スライドを作成する
Step3: それぞれのスライドは、タイトル、データの分析結果の説明、グラフで構成する
```

あるいは
Prompt:

```cmd
ここまでの情報を考慮して、python-pptx を使用して、別のPowerPointファイルを作成してください。スライドは以下の構成にします。構成の各項目で不足している情報があったら、作成してください。

構成:###
ファイルのタイトル
全体の特徴的な項目。そしてFAQ
それぞれの項目を説明する概要文とグラフ
###
```

出力が途中で止まったら、作業を継続するように指示します。
```cmd
作業を続けて実行してください。
```

## 5. おまけ

時系列の変化があるグラフは、レーシングバーチャートも作成できます。


Prompt:
```cmd
以下の要件のダウンロード可能なファイルを作成してください。

### 要件 ###
- .HTML のダッシュボード
- 日本語フォントの利用
- レーシングバーチャートのビジュアル
- データは1か月ごとになっているので、1年に合計をする
- ページは、機能的なデザインにする
- 装飾は必要最低限にする
- ビジュアルはグリッドのレイアウトにする
```


plotly を使ったHTMLダッシュボード作成も出来ます。

Prompt:
```cmd
以下の要件のダウンロード可能なファイルを作成してください。

### 要件 ###
- .HTML のダッシュボード
- 日本語フォントの利用
- plotly を使ったインタラクティブなビジュアルにする
- ページは、機能的なデザインにする
- 装飾は必要最低限にする
- ビジュアルはグリッドのレイアウトにする
```
